<html>
<body>
<pre>

#physonでなろうAPIを使う例

#コメディの解析　タグがコメディ
import requests
import yaml
import time
import webbrowser
import datetime

time_set = 0.5

now = datetime.datetime.now()

t = '01コメディをキーワードにを含む_{0:%Y%m%d}.txt'.format(now) #test_20170910
#時刻の書き込み
dt_now = datetime.datetime.now()
nowtime = dt_now.strftime('%Y-%m-%d %H:%M:%S')
with open(t,mode='w',encoding='utf-8') as f:
    f.write(nowtime)


shousetu_type_set =['t','re']

length_set = ['-50','51-100','101-199','200','201-205','206-210','211-220','221-230','231-240','241-250','251-260','261-271','271-280','281-290','291-300','301-350','351-400','401-430','431-470','471-500','501-550','551-600','601-650','651-700','701-750','751-800','801-900','901-1000','1001-1100','1101-1300','1301-1600','1601-2000','2001-2500','2501-3000','3001-3500','3501-4000','4001-5000','5001-6500','6501-8000','8001-9000','9001-10000','10001-15000','15001-20000','20001-30000','30001-40000','40001-50000','50001-100000','100001-120000','120001-200000','200001-500000','500001-']
# length = ['0-1000000000000']

kaiwa_set = ['0','1-3','4-6','7-10','11-15','16-20','21-25','26-30','31-35','36-40','41-45','46-50','51-55','56-60','61-70','71-80','81-90','91-99','100']
# kaiwa = ['0-100']

for shousetu_type in shousetu_type_set:
    for length in length_set:
        for kaiwa in kaiwa_set:
                payload = {'out': 'yaml','of':'g-gp','lim':500,'notgenre':9801,'kaiwaritu':kaiwa,'length':length,'word':'コメディ','keyword':1,'title':1,'ex':1,'type':shousetu_type}
                r = requests.get('https://api.syosetu.com/novelapi/api/', params=payload).text
                #書き込みテキストファイルの指定
                with open(t,mode='a',encoding='utf-8') as f:
                    f.write(r)
                time.sleep(time_set)


t = '01コメディをキーワードに含まないコメディジャンル_{0:%Y%m%d}.txt'.format(now) #test_20170910
#時刻の書き込み
dt_now = datetime.datetime.now()
nowtime = dt_now.strftime('%Y-%m-%d %H:%M:%S')
with open(t,mode='w',encoding='utf-8') as f:
    f.write(nowtime)

for shousetu_type in shousetu_type_set:
    for length in length_set:
        for kaiwa in kaiwa_set:
                payload = {'out': 'yaml','of':'g-gp','lim':500,'genre':307,'kaiwaritu':kaiwa,'length':length,'notword':'コメディ','keyword':1,'title':1,'ex':1,'type':shousetu_type}
                r = requests.get('https://api.syosetu.com/novelapi/api/', params=payload).text
                #書き込みテキストファイルの指定
                with open(t,mode='a',encoding='utf-8') as f:
                    f.write(r)
                time.sleep(time_set)


t = '02ラブコメタグかつコメディタグを含まない_{0:%Y%m%d}.txt'.format(now) #test_20170910
#時刻の書き込み
dt_now = datetime.datetime.now()
nowtime = dt_now.strftime('%Y-%m-%d %H:%M:%S')
with open(t,mode='w',encoding='utf-8') as f:
    f.write(nowtime)

for shousetu_type in shousetu_type_set:
    for length in length_set:
        for kaiwa in kaiwa_set:
                payload = {'out': 'yaml','of':'g-gp','lim':500,'genre':9801,'kaiwaritu':kaiwa,'length':length,'word':'ラブコメ','keyword':1,'title':1,'ex':1,'notword':'コメディ','type':shousetu_type}
                r = requests.get('https://api.syosetu.com/novelapi/api/', params=payload).text
                #書き込みテキストファイルの指定
                with open(t,mode='a',encoding='utf-8') as f:
                    f.write(r)
                time.sleep(time_set)


t = '02コメディタグのみでラブコメなし_{0:%Y%m%d}.txt'.format(now) #test_20170910
#時刻の書き込み
dt_now = datetime.datetime.now()
nowtime = dt_now.strftime('%Y-%m-%d %H:%M:%S')
with open(t,mode='w',encoding='utf-8') as f:
    f.write(nowtime)

for shousetu_type in shousetu_type_set:
    for length in length_set:
        for kaiwa in kaiwa_set:
                payload = {'out': 'yaml','of':'g-gp','lim':500,'genre':9801,'kaiwaritu':kaiwa,'length':length,'notword':'ラブコメ','keyword':1,'title':1,'ex':1,'word':'コメディ','type':shousetu_type}
                r = requests.get('https://api.syosetu.com/novelapi/api/', params=payload).text
                #書き込みテキストファイルの指定
                with open(t,mode='a',encoding='utf-8') as f:
                    f.write(r)
                time.sleep(time_set)


t = '02ラブコメとコメディ両方_{0:%Y%m%d}.txt'.format(now) #test_20170910
#時刻の書き込み
dt_now = datetime.datetime.now()
nowtime = dt_now.strftime('%Y-%m-%d %H:%M:%S')
with open(t,mode='w',encoding='utf-8') as f:
    f.write(nowtime)

for shousetu_type in shousetu_type_set:
    for length in length_set:
        for kaiwa in kaiwa_set:
                payload = {'out': 'yaml','of':'g-gp','lim':500,'genre':9801,'kaiwaritu':kaiwa,'length':length,'keyword':1,'word':'コメディ　ラブコメ','type':shousetu_type}
                r = requests.get('https://api.syosetu.com/novelapi/api/', params=payload).text
                #書き込みテキストファイルの指定
                with open(t,mode='a',encoding='utf-8') as f:
                    f.write(r)
                time.sleep(time_set)

print("end")
#   n-l-ga-gp-nt-u-gf-gl-g-izk-ir-i

</pre>
</body>
</html>
